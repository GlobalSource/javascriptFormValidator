/*!
 * JavaScript Validator Library v1.0
 * To perform effective validation and filter with form elements.
 *
 * Author : Shankar Thiyagaraajan
 * Email  : shankarthiyagaraajan@gmail.com
 * Github : https://github.com/shankarThiyagaraajan
 *
 * Source
 * https://github.com/global-source/javascript_form_validator
 *
 * Site
 * https://global-source.github.io/javascript_form_validator/
 *
 * Copyright 2017
 *
 * Released under the MIT license
 * https://github.com/global-source/javascript_form_validator/blob/master/LICENSE
 *
 * Date: 2017-07-21
 */

var firstErrorHit=!1,jsValidator={formData:!1,onlyFilter:!1,jsForm:!1,jsSettings:!1,jsFormError:!1,formErrorList:{},forceFilter:!1,initialLoad:!0,option:!1,onChange:!1,init:function(e){return jsLogger.table(e),this.option=e,this.onlyFilter=e.onlyFilter,this.onChange=e.onChange,"undefined"==typeof e.errorClass&&(e.errorClass="js-error-cop"),this.jsSettings=jsSettings.init(e),this.jsForm=jsForm.init(e),this.jsFormError=jsFormError.init(),this.forceFilter=e.forceFilter,this.check(),this.submitListener(this.jsForm.formCore,this),this},submitListener:function(e,t){(!1===this.onlyFilter||"undefined"==typeof this.onlyFilter)&&document.querySelector("#"+e).addEventListener("submit",function(e){!1===t.check()&&e.preventDefault()})},update:function(){var e=this.option;this.onlyFilter=e.onlyFilter,this.jsSettings=jsSettings.init(e),this.jsForm=jsForm.init(e),this.jsFormError=jsFormError.init()},check:function(){var e=!1,t=this.jsForm,r=this.formErrorList,i=[];return r.input=this.elemLoop("input",t.input),r.textArea=this.elemLoop("textArea",t.textArea),r.select=this.elemLoop("select",t.select),jsLogger.out("Error List",this.formErrorList),i.push({errorElem:r}),0===r.input.length&&0===r.textArea.length&&0===r.select.length&&(e=!0),0==this.initialLoad&&validationResponse.init(r,this.option),this.initialLoad=!1,helper.scrollToError(),e},elemLoop:function(e,t){var r=[];if(null===t||"undefined"==typeof t)return!1;t=t.reverse();for(var i in t)if(t[i]){var n=t[i];this.applyFilters(n),1==this.onChange&&this.applyGlobalListener(n),(!1===this.onlyFilter||"undefined"==typeof this.onlyFilter)&&(r=jsRuleSets.checkValidation(n,r))}return r},applyFilters:function(e){"number"==e.type&&jsFilter.number(e),"email"==e.type&&jsFilter.email(e),"file"==e.type&&jsFilter.file(e),e.getAttribute("data-allow")&&jsFilter.string(e),e.getAttribute("pattern")&&jsFilter.pattern(e)},applyGlobalListener:function(e){e.addEventListener("change",this.quickValidation,!1)},quickValidation:function(e){var t=[],r=e.target;t=jsRuleSets.checkValidation(r,t),validationResponse.process(t)},validate:function(){return this.check()}},jsFilter={checkStatus:function(e){var t;return t=!0,!1===jsValidator.forceFilter&&(t=!1,!0===e.required&&(t=!0)),t},number:function(e){var t=this.checkStatus(e);!0===t&&e.addEventListener("keypress",this.isNumberKey,!1)},string:function(e){var t=e.getAttribute("data-allow"),r=this,i=this.checkStatus(e);switch(t){case"onlyAlpha":!0===i&&e.addEventListener("keypress",r.isAlpha,!1);break;case"string":!0===i&&e.addEventListener("keypress",r.isAlphaNumeric,!1);break;default:!0===i&&e.addEventListener("keypress",r.isPatternValid,!1)}},pattern:function(e){var t=this,r=this.checkStatus(e);!0===r&&e.addEventListener("keypress",t.isPatternValid,!1)},email:function(e){var t=this.checkStatus(e);!0===t&&e.addEventListener("keypress",jsRuleSets.email,!1)},file:function(e){var t=this.checkStatus(e);!0===t&&e.addEventListener("change",jsRuleSets.file,!1)},limit:function(e){var t=this.checkStatus(e);!0===t&&e.addEventListener("input",this.isInLimit,!1)},isInLimit:function(e){var t=e.target.value;if(!0===helper.isWindowAction(e))return!0;var r=e.target.min,i=e.target.max;r||(r=1),i||(i=31);var n=new RegExp("^[0-9]+$"),s=String.fromCharCode(e.charCode?e.charCode:e.which);(!1===n.test(s)||parseInt(t)>i||parseInt(t)<r)&&e.preventDefault();var o=+this.value;return this.value.length?(this.value=isNaN(o)?r:o>i?i:r>o?r:o,void(e.target.value=e.target.value.substring(0,e.target.value.length-1))):!1},isAlpha:function(e){if(!0===helper.isWindowAction(e))return!0;var t=pattern.validate(e,"a-zA-Z");!1===t&&e.preventDefault()},isAlphaNumeric:function(e){if(!0===helper.isWindowAction(e))return!0;var t=pattern.validate(e,"a-zA-Z0-9");!1===t&&e.preventDefault()},isValidPassword:function(e){var t=e.which?e.which:e.keyCode;if(32===t)return e.preventDefault(),!1;if(!0===helper.isWindowAction(e))return!0;var r=pattern.validate(e,"a-zA-Z0-9");!1===r&&e.preventDefault()},isPatternValid:function(e){if(!0===helper.isWindowAction(e))return!0;var t=pattern.validate(e,"a-zA-Z0-4");!1===t&&e.preventDefault()},isNumberKey:function(e){if(!0===helper.isWindowAction(e))return!0;var t=e.which?e.which:e.keyCode;return 46===t||t>31&&(48>t||t>57)?(e.preventDefault(),!1):!0}},jsSettings={errorColor:!1,errorTemplate:!1,init:function(e){return this.errorColor=e.errorColor,this.errorTemplate=e.errorTemplate,this},log:function(){jsLogger.out(this.errorColor),jsLogger.out(this.errorTemplate)}},jsForm={form:!1,formCore:!1,input:!1,select:!1,textArea:!1,label:!1,forceFilter:!1,init:function(e){return jsLogger.out("Form",e.form),this.options=e,this.forceFilter=e.forceFilter,this.registerForm(e.form),this.parseForm(this.form),this.required(),this},registerForm:function(e){return"undefined"==typeof e&&jsLogger.out("Form Identification","Form Identification is Missing !"),null===e?!1:(this.form=document.getElementById(e),null===this.form&&jsLogger.out("Status 503","Failed to Proceed !"),void(this.formCore=e))},parseForm:function(e){return null===e?!1:(this.input=e.getElementsByTagName("input"),this.select=e.getElementsByTagName("select"),this.textArea=e.getElementsByTagName("textarea"),void(this.label=e.getElementsByTagName("label")))},required:function(){var e=this.forceFilter;this.input=jsField.required(this.input,e),this.select=jsField.required(this.select,e),this.textArea=jsField.required(this.textArea,e)},log:function(){jsLogger.out("Form",this.form),jsLogger.out("input",this.input),jsLogger.out("select",this.select),jsLogger.out("textarea",this.textArea),jsLogger.out("labels",this.label)}},jsField={required:function(e,t){for(var r=[],i=0;i<e.length;i++)(e[i].required===!0||!0===t)&&r.push(e[i]);return r}},jsRuleSets={checkValidation:function(e,t){var r=!0;if(jsRuleSets.isSet(e)||(t.push({el:e,type:"required",id:e.name+"_new1_1_1xv_resp"}),firstErrorHit=e.name+"_new1_1_1xv_resp"),e.min&&jsRuleSets.isSet(e)&&(jsRuleSets.min(e)||(t.push({el:e,type:"min",id:e.name+"_new1_1_1xv_resp"}),firstErrorHit=e.name+"_new1_1_1xv_resp",r=!1)),e.max&&jsRuleSets.isSet(e)&&(jsRuleSets.max(e)||(t.push({el:e,type:"max",id:e.name+"_new1_1_1xv_resp"}),firstErrorHit=e.name+"_new1_1_1xv_resp",r=!1)),"email"==e.type&&jsRuleSets.isSet(e)&&(jsRuleSets.email(e)||(t.push({el:e,type:"email",id:e.name+"_new1_1_1xv_resp"}),firstErrorHit=e.name+"_new1_1_1xv_resp",r=!1)),"password"==e.type&&jsRuleSets.isSet(e)&&(jsRuleSets.compare(e)||(t.push({el:e,type:"password",id:e.name+"_new1_1_1xv_resp"}),firstErrorHit=e.name+"_new1_1_1xv_resp",r=!1)),!0===r&&""!==e.name){var i=document.getElementById(e.name+"_new1_1_1xv_resp");"undefined"!=typeof i&&null!==i&&(i.innerHTML="")}return t},isSet:function(e){if(!1===e.required)return!0;var t=!0,r=e.value;return(0===r.length||""===r||" "===r||"[]"===r)&&(t=!1),t},min:function(e){if(!1===e.required)return!0;var t=!0,r=e.value,i=e.min;return r.length<i&&0!=r.length&&(t=!1),t},max:function(e){if(!1===e.required)return!0;var t=!0,r=e.value,i=e.max;return r.length>i&&0!=r.length&&(t=!1),t},email:function(e){if(!1===e.required)return!0;var t=!1,r=e.value;return"undefined"==typeof r?!1:(r=r.toString(),/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(r)&&(t=!0),r||(t=!1),t)},file:function(e){var t,r,i=e.target.getAttribute("data-extensions"),n=e.target;if(""===i)return!0;t=-1===i.indexOf(",")?[i]:i.split(",");var s=n.value;return s=s.toLowerCase(),r=new RegExp("("+t.join("|").replace(/\./g,"\\.")+")$").test(s),!1===r?(alert('Allowed file types are "'+i+'" !'),e.target.value="",!1):!0},phone:function(e,t){if(!1===e.required)return!0;var r=!0;return""===e.value&&(r=!1),r},compare:function(e){var t=!1;!1===e.required&&(t=!0);var r=e.getAttribute("data-check");if(("undefined"==typeof r||null==r)&&(t=!1),null===r&&(r=e.getAttribute("data-parent")),null===r)t=!1;else{r=r.toString();var i=document.getElementById(r);e.value===i.value&&(t=!0)}return t}},jsFormError={errorHit:!1,errorCss:!1,successCss:!1,init:function(){this.errorHit=!1,this.errorCss="border-color: red;border-radius: 5px;color: red;",this.successCss="border-color: green;border-radius: 5px;color: green;"},log:function(){},style:function(e){this.errorCss=e.error,this.successCss=e.success}},jsLogger={out:function(e,t){console.log("======"+e+"======"),console.log(t),console.log("------------------------")},bulk:function(e){console.log(e)},table:function(e){console.table(e)}},helper={isWindowAction:function(e){var t=e||window.event,r=t.shiftKey||t.which;return 9===r||0===r||8===r||32===r||13===r||8===r||r>=35&&40>=r?!0:(r=String.fromCharCode(r),0===r.length?!0:!1)},scrollToError:function(){var e=validationResponse.getClass();if(0===document.getElementsByClassName(e).length)return!1;document.getElementsByClassName(e)[0].setAttribute("id","__header_error_target_temp");var t="#"+document.getElementsByClassName(e)[0].id;window.location.href=t,document.getElementsByClassName(e)[0].removeAttribute("id"),this.removeHash(t)},scrollToItem:function(e){var t=e;-1===t.indexOf("#")&&(t="#"+t),window.location.href=t,this.removeHash(t)},removeHash:function(e){var t=window.location.href;t=t.replace(e,""),window.history.pushState("","Title",t)}},pattern={getDefault:function(e,t){"undefined"==typeof t&&(t="");var r=e.target.getAttribute("data-allowSpecial"),i=e.target.pattern;console.log(i.length);var n;return r||null!==r||(r=""),r=r.toString(),n=""!==i&&i.length>0&&null!==i?i:"^["+t+r+"]+$"},validate:function(e,t){var r=this.getDefault(e,t),i=new RegExp(r),n=String.fromCharCode(e.charCode?e.charCode:e.which);return i.test(n)}},validationResponse={active_class:!1,init:function(e,t){this.errorMessage=t.message,this.active_class=t.errorClass,this.input(e.input),this.select(e.select),this.textArea(e.textArea)},input:function(e){this.process(e)},select:function(e){this.process(e)},getClass:function(){return this.active_class},textArea:function(e){this.process(e)},process:function(e){var t="",r=this.getClass();for(var i in e)if(e[i].el&&!0===e[i].el.required){var n=e[i],s=e[i].type;t=this.template(n,s);var o=document.getElementById(n.id);"undefined"==typeof o||"undefined"===o||null===o?(o=document.createElement("span"),o.setAttribute("id",n.id),o.setAttribute("class",r),o.innerHTML=t):o.innerHTML=t,n.el.parentNode.insertBefore(o,n.el.nextSibling)}},template:function(e,t){var r="",i="",n=e.el.getAttribute("data-message");return("undefined"==typeof n||""===n||null===n)&&("undefined"!=typeof this.errorMessage&&"undefined"!=typeof this.errorMessage[t]?(t=this.errorMessage[t],e.el.getAttribute("data-message"),t&&(i=t,("min"==e.type||"max"==e.type)&&("min"==e.type&&(r=e.el.min),"max"==e.type&&(r=e.el.max),i=i.replace("[INDEX]",r)))):i=this["default"](t),n=i),n},"default":function(e){var t=this.getClass(),r={required:'<span class="'+t+'">This field is required.</span>',min:'<span class="'+t+'">This field length is too low.</span>',max:'<span class="'+t+'">This field length is exceeds the limit.</span>',password:'<span class="'+t+'">Password does not match.</span>',email:'<span class="'+t+'">Email is not valid.</span>',file:'<span class="'+t+'">This file is not allowed.</span>'};return"string"!=typeof e?!1:"undefined"==typeof r[e]?!1:r[e]}};